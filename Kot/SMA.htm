<!DOCTYPE html>
<html lang="ru"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta charset="UTF-8">
	<title>Робострой</title>
	<meta name="title" content="Робострой: прибыльные торговые системы — Лаборатория — Скользящая средняя с фильтрацией"><meta name="google-site-verification" content="trCz4sxH92uoDT1LDcO76U3lftTV-_CRmLQ2kSu9H0w">
	<meta name="yandex-verification" content="58c4dd8634c285ee">
	<link rel="stylesheet" href="SMA_files/common.css">
	
	<!--[if lte IE 6]><link rel="stylesheet" href="/static/css/ie6.min.css?20140604">
	<![endif]-->
	<!--[if lte IE 7]><link rel="stylesheet" href="/static/css/ie7.min.css?20140604">
	<![endif]-->
	<link rel="shortcut icon" href="http://robostroy.ru/favicon.ico">
	<link rel="alternate" type="application/rss+xml" title="Заметки Робострой" href="http://robostroy.ru/rss.ashx">
	
	<script src="SMA_files/piwik.js" defer="defer" async="" type="text/javascript"></script><script src="SMA_files/dc.gif" async="" type="text/javascript"></script><script src="SMA_files/jquery.js"></script>
	<script src="SMA_files/jquery_004.js"></script>
	<script src="SMA_files/jcarousellite.js"></script>
	<script src="SMA_files/jquery_002.js"></script>
	<script src="SMA_files/jquery_003.js"></script>
	<script src="SMA_files/swfobject.js"></script>
<script>Passport = { Settings: { Agent: 'http://robostroy.ru/agent.ashx', Agent64: 'aHR0cDovL3JvYm9zdHJveS5ydS9hZ2VudC5hc2h4', Area: 'robostroy', Root: 'https://passport.bcs.ru/', Url64: 'aHR0cDovL3JvYm9zdHJveS5ydS9sYWIvbWF3Zi5hc3B4' }, Profile: { Id: null, EMail: null, Surname: null, Name: null, MiddleName: null, Birthdate: null, Client: null } };</script><script src="SMA_files/robostroy.js"></script><style media="screen" type="text/css">#flash-banner {visibility:hidden}</style></head>
<body>
<div id="body">
	<iframe src="SMA_files/check.htm" style="display: none"></iframe>
	<div id="header">
		<div class="logo">
			<a href="http://robostroy.ru/"><img src="SMA_files/robostroy.png" alt="Робострой"></a>
		</div>
		<div id="linki" class="clearfix">
			<ul class="about clearfix">
				<li><a href="http://robostroy.ru/about/">О проекте</a></li>
			</ul>
			<ul class="social clearfix">
				<li><!--noindex--><a rel="nofollow" href="http://www.facebook.com/sharer.php?u=http%3a%2f%2frobostroy.ru%2flab%2fmawf.aspx"><i class="facebook"></i></a><!--/noindex--></li>
				<li><!--noindex--><a rel="nofollow" href="http://twitter.com/share?text=%d0%a0%d0%be%d0%b1%d0%be%d1%81%d1%82%d1%80%d0%be%d0%b9&amp;url=http%3a%2f%2frobostroy.ru%2flab%2fmawf.aspx"><i class="twitter"></i></a><!--/noindex--></li>
				<li><!--noindex--><a rel="nofollow" href="http://vkontakte.ru/share.php?url=http%3a%2f%2frobostroy.ru%2flab%2fmawf.aspx"><i class="vk"></i></a><!--/noindex--></li>
				<li><!--noindex--><a rel="nofollow" href="http://connect.mail.ru/share?url=http%3a%2f%2frobostroy.ru%2flab%2fmawf.aspx&amp;title=%d0%a0%d0%be%d0%b1%d0%be%d1%81%d1%82%d1%80%d0%be%d0%b9&amp;imageurl=http%3a%2f%2frobostroy.ru%2fimg%2frobostroy.png"><i class="moimir"></i></a><!--/noindex--></li>
			</ul>
			<ul class="passport clearfix">
				<li><a class="enter" data-action="Passport.Logon()" href="http://robostroy.ru/#"><i class="lock"></i>Войти</a></li>
				
				<li><div class="vline"></div></li>
				<li><a class="signup" data-action="Passport.Registration()" href="http://robostroy.ru/#">Зарегистрироваться</a></li>
			</ul>
		</div>
		<div id="menubar">
			<ul id="mainmenu" class="clearfix">
				<li class="i">
					<!--[if lte IE 7]><table><tr><td><![endif]-->
					<a href="http://robostroy.ru/faq/" class="ia"><i class="robot"></i>Как создать<br>торгового робота<i class="arr"></i></a>
					<!--[if lte IE 7]></td></tr></table><![endif]-->
					<div class="pulldown">
						<ul>
							<li><a href="http://robostroy.ru/faq/webinar/">Вебинары</a></li>
							<li><a href="http://robostroy.ru/faq/video/">Видеокурсы</a></li>
							<li><a href="http://robostroy.ru/faq/library/">Библиотека</a></li>
							<li><a href="http://robostroy.ru/faq/software/">Программы для разработки торговых роботов</a></li>
							<li class="last"><a href="http://robostroy.ru/faq/drives/">Приводы</a></li>
						</ul>
					</div>
				</li>
				<li class="i">
					<!--[if lte IE 7]><table><tr><td><![endif]-->
					<a href="http://robostroy.ru/lab/" class="ia"><i class="lab"></i>Лаборатория<i class="arr"></i></a>
					<!--[if lte IE 7]></td></tr></table><![endif]-->
					<div class="pulldown">
						<ul>
							<li><a href="http://robostroy.ru/lab/mai.aspx">Пересечение скользящих средних</a></li>
							<li><a href="http://robostroy.ru/lab/mawf.aspx">Скользящая средняя с фильтрацией</a></li>
							<li class="last"><a href="http://robostroy.ru/lab/hi-low.aspx">Торговая стратегия на пробитие hi-low</a></li>
						</ul>
					</div>
				</li>
				<li class="i">
					<!--[if lte IE 7]><table><tr><td><![endif]-->
					<a href="http://robostroy.ru/community/" class="ia"><i class="people"></i>Сообщество<i class="arr"></i></a>
					<!--[if lte IE 7]></td></tr></table><![endif]-->
					<div class="pulldown">
						<ul>
							<li><a href="http://robostroy.ru/community/default.aspx?cid=strategies">Стратегии</a></li>
							<li><a href="http://robostroy.ru/community/default.aspx?cid=robots">Роботы</a></li>
							<li><a href="http://robostroy.ru/community/default.aspx?cid=theory">Теория</a></li>
							<li><a href="http://robostroy.ru/community/default.aspx?cid=technologies">Технологии</a></li>
							<li><a href="http://robostroy.ru/community/default.aspx?cid=news">Новости</a></li>
							<li class="last"><a href="http://robostroy.ru/community/default.aspx?cid=analytics">Торговые рекомендации</a></li>
						</ul>
					</div>
				</li>
				<li class="i">
					<!--[if lte IE 7]><table><tr><td><![endif]-->
					<a href="http://robostroy.ru/robots/" class="ia"><i class="dev"></i>Биржа роботов<i class="arr"></i></a>
					<!--[if lte IE 7]></td></tr></table><![endif]-->
					<div class="pulldown">
						<ul>
							<li><a href="http://robostroy.ru/robots/">Биржа роботов</a></li>
							<li><a href="http://robostroy.ru/robots/monthly.aspx">Роботы</a></li>
							<li><a href="http://robostroy.ru/robots/dev.aspx">Разработка роботов</a></li>
							<li><a href="http://robostroy.ru/robots/audit.aspx">Аудит торговых систем</a></li>
							<li class="last"><a href="http://robostroy.ru/robots/positions.aspx">Позиции торговых систем</a></li>
						</ul>
					</div>
				</li>
				
			</ul>
			<div id="b_menubar_searchform">
				<form action="/search/" method="get">
					<table>
						<tbody><tr>
							<td>
								<input class="ysearch-text ysearch-text-logo" name="text">
							</td>
						</tr>
					</tbody></table>
					<input class="submit" value="" type="submit">
				</form>
			</div>
		</div>
	</div>
	<div id="top-banner">
		<object style="visibility: visible;" id="flash-banner" data="SMA_files/promo_01.swf" type="application/x-shockwave-flash" width="100%" height="55"><param value="opaque" name="wmode"></object>
	</div>
	
	

<div id="navigation">
	<a href="http://robostroy.ru/">Главная</a>&nbsp;&nbsp;→&nbsp;&nbsp;<a href="http://robostroy.ru/lab/">Лаборатория</a>&nbsp;&nbsp;→&nbsp;&nbsp;Скользящая средняя с фильтрацией
</div>
	<div id="wrapper" class="clearfix">
		<div id="right">
			<div class="shadow-box">
				

<div class="b-lab-menu">
	<div class="zero"></div>
	<div class="first"><a href="http://robostroy.ru/lab/mai.aspx">Пересечение скользящих средних</a></div>
	<div class="first"><a href="http://robostroy.ru/lab/mawf.aspx">Скользящая средняя с&nbsp;фильтрацией</a></div>
	<div class="second"><a href="http://robostroy.ru/lab/hi-low.aspx">Торговая стратегия на&nbsp;пробитие hi-low</a></div>
</div>
			</div>
		</div>
		<div id="left">
			<div class="shadow-box">
				<div class="shadow-box-wrapper">
					<div class="shadow-box-header">
						<div class="shadow-box-header-bg-laboratory">
							<h3><span>Скользящая средняя с фильтрацией</span></h3>
						</div>
					</div>
					<div class="b-lab-content">
						<h4><img src="SMA_files/t.png" alt="">Скользящая средняя с фильтрацией</h4>
						<table>
						<tbody><tr>
							<td>
								<img src="SMA_files/m-graph-2.jpg" alt="" class="pic2">
							</td>
							<td>
								<img src="SMA_files/m-data-2.png" alt="" class="pic">
								<p>Фильтр — это дополнительное условие к первичному сигналу, 
которое позволяет исключить некоторые убыточные сделки. к пересечению 
цены и скользящей средней добавим положительный наклон этой скользящей 
средней как фильтр. На графике сразу видно как исчезло большое 
количество убыточных сделок, и мы достигли то, что задумали.</p>
							</td>
						</tr>
						</tbody></table>
					</div>
				</div>
			</div>
			<div class="shadow-box">
				<div class="shadow-box-wrapper">
					<div class="shadow-box-header">
						<div class="shadow-box-header-bg-laboratory">
							<h3><span>Дневник разработки торгового робота</span></h3>
						</div>
					</div>
					<div class="b-lab-content b-lab-content-blog">
						<p class="author">Автор: Николай Солабуто</p>
						<p>
							Каждый, кто впервые приходит на фондовый рынок, задается вопросом: <b>как торговать, чтобы не потерять деньги и еще заработать</b>. Если спросиь об этом профессионала, ответ будет однозначным — создавать систему принятия решений.<br>
							<b>Система принятия решений</b> — <b>это набор жестких правил, которые разделены на два блока:</b>
						</p>
						<ul>
							<li>первый блок — <b>«Торговый метод»</b>;</li>
							<li>второй блок — <b>«Управление капиталом»</b>.</li>
						</ul>
						<p>
							<b>Торговый метод</b> — инструмент, который помогает ответить на вопрос: «<b>Что делать?</b>». Ответов три — покупать, продавать или держать (ничего не делать).<br>
							<b>Управление капиталом</b> — инструмент, который отвечает на один вопрос: <b>«Сколько?»</b>. Планируя сделку, инвестор должен знать, сколько акций (лотов) брать.<br>
							<b>Я предлагаю пройти по шагово путь создания торгового метода.</b>
						</p>
						<p><b><em>Шаг 1. Идея</em></b></p>
						<p>Торговая система начинается с идеи. Это правила образующие 
торговый метод. Метод может быть простым или сложным, на ваше 
усмотрение. В конечном счете, это не имеет значения. Главное, чтобы она 
зарабатывала деньги.</p>
						<p><img src="SMA_files/0.jpg" alt=""></p>
						<p>Подробней этот блок опишу позже.</p>
						<p><b><em>Шаг 2. Сформулируйте торговый метод</em></b></p>
						<p>
							Все условия должны пониматься однозначно.<br>
							Например, предписание входить в длинную позицию, когда быстрая 
скользящая средняя пересечет снизу вверх медленную скользящую среднюю, 
означает, что следует купить на открытии следующего бара по цене 
закрытия бара, в котором произошло пересечение. И никак иначе! Не надо 
ждать, пойдет рынок в вашу сторону или, наоборот, отката для вхождения 
по более привлекательной цене. Нужно просто купить.<br>
							Неполное и/или абстрактное определение правил стратегии — одна из самых распространенных ошибок при разработке систем.
						</p>
						<p><img src="SMA_files/1.jpg" alt=""></p>
						<p>
							В окончательном виде торговая система представляет набор четких правил и формул.<br>
							Для трейдеров, которые не владеют языками программирования, 
разработано специальное дружественное программное обеспечение. Это так 
называемые программы для технического анализа графиков — TradeMatic, 
MetaStock, Omega, Wealth-Lab и другие. Они позволяют трейдеру описывать и
 тестировать торговые идеи, не имея опыта программирования.
						</p>
						<p><b><em>Шаг 3. Тест</em></b></p>
						<p>Тестирования включает три основных стадии:</p>
						<ul>
							<li>убедиться, что все формулы считаются компьютером так, как должны исчисляться согласно торговой идеи;</li>
							<li>получить предварительное представление о доходах и риске;</li>
							<li>получить представление об устойчивости торгового метода.</li>
						</ul>
						<p>
							На первом этапе нужно посмотреть, правильно ли система исполняет 
вашу идею. Другими словами, генерирует ли она сигнал на покупку именно 
на том баре, на котором короткая скользящая средняя пересекает длинную 
скользящую среднюю, или что исполняется любое другое условие, которое вы
 запраграмировали.<br>
							После компьютерного тестирования осуществляется проверка 
торгового метода. Необходима представительная выборка данных, чтобы 
каждая формула и правило торговой модели были задействованы для 
генерации как минимум одного сигнала на покупку и продажу. Полученные 
торговые сигналы проверяются визуально: вы пробегаете глазами график и 
смотрите, ставит ли компьютер стрелки туда, где они, по идее, должны 
находиться. Если система функционирует правильно, первая стадия 
тестирования завершена. Если неправильно, нужно проверить код системы; 
возможно, там допущена ошибка.<br>
							Просмотр всех переменных, правил, ордеров на вход и выход должен 
подтвердить, что сделки генерировались соответствующими формулами и 
правилами. Единственный способ получить желаемый результат, — сравнить 
вычисления, полученные в ручном режие, с вычислениями, выполненными 
компьютером. Достаточно ограниченной выборки (несколько сделок).<br>
							Следующий шаг — проверка протокола сделок. Это отчет в табличной 
форме, содержащий дату покупки или продажи, цену и итоговые значения 
прибыли или убытка по каждой закрытой сделке. Цель — подтвердить, что 
модель покупает (продает) в тот момент и по той цене, по которой должна.
 Другими словами, необходимо удостовериться в действиях модели согласно 
вашему замыслу. По ходу такая проверка раскрывает все прочие 
недоработки, пропущенные во время ручного контроля.<br>
							Затем переходим к следующему этапу — получаем представление о 
профиле прибыли и риске торгового метода до оптимизации. Торговый метод 
должен быть умеренно прибыльным на нескольких рынках и в течение ряда 
временных отрезков. Каждый тест не обязательно будет показывать прибыль.
 Но если всякий раз фиксируется проигрыш, от такого метода лучше 
отказаться. Первый тест дает общее представление о прибыли и риске; 
панорамный обзор эффективности системы на основе «разумных» значений 
параметров. Главное правило — временное падение капитала не должны 
превышать среднегодовую прибыль (в рамках данного этапа придавать 
большое значение показателю прибыльности некорректно).
						</p>
						<p><img src="SMA_files/2.jpg" alt=""></p>
						<p>От торгового метода, который демонстрирует низкую эффективность, следует отказаться.</p>
						<p><b><em>Шаг 4. Оптимизация</em></b></p>
						<p>
							Оптимизировать что-либо, значит, сделать его использование более эффективным.<br>
							Проведя тест, мы получили прибыльную торговую методику, но ее 
результаты основаны только на одном значении — стандартном параметре 
индикатора. Чтобы повысить отдачу метода, его нужно изменить.<br>
							Оптимизация может улучшить один или несколько параметров:
						</p>
						<ol start="1" type="1">
							<li>Повышение среднегодовой ставки доходности.</li>
							<li>Снижение годового риска, измеряемого временным максимальным проседанием капитала.</li>
							<li>Повышение доходности без повышения риска.</li>
						</ol>
						<p>
							Перед оптимизацией трейдер должен определить для себя норму прибыли для приемлемого уровня риска.<br>
							Еще существуют так называемые параметры психологического 
комфорта. Например, процент выигрышных сделок. Если в результате 
оптимизации мы получаем больший процент прибыльных сделок, это 
значительно расширяет «зону комфорта» трейдера, что приводит к большей 
уверенности в модели и готовности следовать ей, не пытаться оспаривать 
поступающие сигналы.<br>
							Некорректная оптимизация часто приводит к «подстройке». Если 
допущена ошибка, торговый метод покажет очень хорошие результаты в 
процессе оптимизации и плохую эффективность при реальной торговле. 
Поэтому методы правильной оптимизации крайне важны для успешной 
торговли.
						</p>
						<p><img src="SMA_files/2_1.jpg" alt=""></p>
						<p>
							Цель оптимизации — найти значения параметров модели, которые 
будут сообщать ей максимальную эффективность в реальном времени.<br>
							Инвесторы, проводящие оптимизацию в программе для технического 
анализа графиков, получают список результатов, первую строчку которого 
занимают параметры переменной с максимальной доходностью. Они 
воспринимают эти параметры как самые лучшие для торгового метода. Но 
если взять весь список оттестированных параметров, независимо от 
доходности, и построить график, где по горизонтали будут параметры 
переменной, а по вертикали — доходность, получится весьма интересная 
картина.
						</p>
						<p><img src="SMA_files/3.jpg" alt=""></p>
						<p>
							На графике видно, как максимальная доходность достигается при 
определенном значение усреднения индикатора. Проблема заключается в том,
 что медиана не постоянна и каждый раз перемещается по горизонтали. 
Причем не раз в год или вслед за изменениями рыночной ситуации, а при 
каждой новой сделке. То есть у каждой сделки есть свой максимально 
эффективный период усреднения индикатора. Таким образом, период 
усреднения не оптимален, а пиковая доходность будет постоянно 
мигрировать. В результате при реальной торговле в будущем наш торговый 
метод даст доходность отличную от ожидаемой и как правило в худшию 
сторону. Если она нас устраивает, можно использовать в торговом методе 
найденный период усреднения. Но лучше выбрать плоский участок и взять 
центральное значение усреднения индикатора на этом участке.<br>
							Разумеется, начиная торговать по своему методу, мы рассчитываем 
на большую доходность, а не на убытки. Поэтому вывод простой: правильная
 оптимизация или никакой. Чтобы не сбиться с заданного курса, следует 
избегать типичных ошибок.
						</p>
						<p><b><em>Шаг 5. Тест в реальном времени</em></b></p>
						<p>После оформления своей идеи в стройный код программы для 
технического анализа графиков, тестирования полученного торгового метода
 на исторических периодах и проведения правильной оптимизации, мы в 
целом готовы выйти на рынок и совершать сделки с использованием 
настоящих, а не виртуальных денег. Каждому на данном этапе не терпится 
поскорее начать торговлю. Но нужно остановиться и провести еще работу. 
Назовем данный шаг тестом в реальном времени. Это может быть симуляция 
торговли в реальном времени без капитала или торговля «в живую» 
маленьким объемом (например, одним лотом), чтобы отрицательные 
результаты не стали фатальными.</p>
						<p><img src="SMA_files/4.jpg" alt=""></p>
						<p>
							Зачем нужен такой тест? Дело в том, что виртуальные сделки, 
совершаемые компьютером на стадии тестирования, отличаются от сделок при
 реальной торговле. В итоге получается искажение. При тестировании 
компьютер вводит или выводит вас из рынка по цене условия совершения 
сделки, не обращая внимания на то, что по этой цене у актива может не 
хватить ликвидности для удовлетворения выставленного приказа или не 
окажется встречной заявки, и придется исполнять приказ по худшей цене 
(отрицательное проскальзывание).<br>
							Например, у вас есть торговый метод, основный на пробое ценового 
уровня. Значит, нужно входить в рынок по цене на один тик выше заданного
 уровня. По ходу теста компьютер так и делает; все сделки получаются 
точно по заданной цене. Но на практике все иначе: цена стремительно 
пробивает условный уровень и взлетает, причем основательно. Вы уже не в 
состоянии получить исполнение по заданной цене, и приходится исполнять 
свой приказ, имея отрицательное проскальзывание, которое уменьшает доход
 от прибыльной сделки и увеличивает убыток системы.
						</p>
						<p><img src="SMA_files/5.jpg" alt=""></p>
						<p>
							Как видим, исполнение сделок на стадии тестирования и в 
реальности неодинаково. Если вы выяснили, что в настоящей торговле 
появляется отрицательное проскальзывание, стоит его учесть. По ходу 
теста в реальном времени вы определяете размер данного проскальзывания, и
 торговый метод отправляется на вторичное тестирование уже с учетом 
данного фактора. Компьютеру дается задание отнимать от прибыльных сделок
 величину проскальзывания, и ее же прибавлять к убыточным сделкам. <br>
							Если по результатам тестирования торговый метод показал 
отрицательный результат, вы возвращаетесь назад, на стадию «Идеи». Если 
положительная доходность сохраняется, и ее размер вас устраивает, можно 
переходить к торговле «живыми» деньгами.
						</p>
						<p><b>Построение торгового метода</b></p>
						<p>Я не ставлю перед собой задачу&nbsp;рассмотреть все торговые 
системы. Их существуетогромное количество; многие описаны&nbsp; в книге 
Джеффри Оуэна Каца и Донна Л. Маккормика «Энциклопедия торговых 
стратегий».</p>
						<p><b><em>Первый блок. Первичный сигнал</em></b></p>
						<p>Любая торговая система начинается с первичного сигнала. Если мы
 изначально решили строить метод на индикаторах технического анализа, 
первичный сигнал будет выглядеть просто – что-то с чем-то пересеклось. 
Например, две скользящие средние или цена со своей скользящей средней 
или Стохастик с уровнем. В MetaStoke 160 встроенных индикаторов и по 
любому из них можно построить первичный сигнал.</p>
						<p><img src="SMA_files/6.jpg" alt=""></p>
						<p>
							К примеру, бирем метод пересечения цены и скользящей средней: 
когда цена пересекает скользящую среднею снизу вверх и закрывается выше 
скользящей средней с выбранным периодом, покупаем; если цена пересекает 
сверху вниз скользящую среднею и закрывается ниже, закрываем свою 
позицию.<br>
							Код стратегии в программе для технического анализа графиков Wealth-Lab выглядит так:
						</p>
						<pre>﻿var Bar, p: integer;
PlotSeries( SMASeries( #Close, 20 ), 0, #Teal, #Thick );
for Bar := 20 to BarCount - 1 do
begin
  if LastPositionActive then
  begin
    p := LastPosition;
    if CrossUnder( Bar, #Close, SMASeries( #Close, 20 ) ) then
    begin
      SellAtMarket( Bar + 1, p, '' );
    end;
  end
  else
  begin
    if not LastPositionActive then
    begin
      if CrossOver( Bar, #Close, SMASeries( #Close, 20 ) ) then
      begin
        BuyAtMarket( Bar + 1, '0' );
      end;
    end;
  end;
end;</pre>
						<p>На графике это выглядит так:</p>
						<p><img src="SMA_files/7.jpg" alt=""></p>
						<p>
							Сначала рынок падал, затем пошел в рост. В данной ситуации нужно 
всего лишь купить. Но, как видим, торговый метод на основании первичного
 сигнала дает слишком много сделок. Если мы протестируем его на 
исторических данных, станет ясно, что убыточных сделок намного больше, 
чем прибыльных (например, 80% к 20%), а коэффициент соотношения средней 
прибыльной сделки к средней убыточной не велик (например 1, 2).<br>
							Что нас не устраивает в этой ситуации? Разумеется, количество 
убыточных сделок. Необходим хотя бы паритет прибылей и убытков (50/50). 
Чтобы устранить ненужные убытки, требуется фильтр.
						</p>
						<p><b><em>Второй блок. Фильтр</em></b></p>
						<p>Фильтр — это дополнительное условие к первичному сигналу, которое позволяет исключить некоторые убыточные сделки.</p>
						<p><img src="SMA_files/8.jpg" alt=""></p>
						<p>Теперь с импровизируем мозговой штурм. Что в нашей ситуации 
может стать фильтром? Ясно, что все 160 встроенных индикаторов не 
понадобятся. Будет вполне достаточно ограниченного набора индикаторов. 
Например:</p>
						<ul>
							<li>Если мы используем в методе скользящую среднею, понимаем, что
 она сбоит при наличии на рынке «мути» — коррекционных движений. Такое 
происходит после длительного падения либо после продолжительного роста. 
Отфильтровать убыточные сделки, которые появляются на коррекции после 
падения, можно, добавив в систему еще одну скользящую среднюю, но более 
медленную. Фильтр, скорее всего, прозвучит так: <b><em>мы игнорируем все сигналы, пока цена находиться ниже медленной скользящей средней. </em></b>Но
 это не спасет от убыточных сделок, приходящих после длительного роста 
либо на промежуточных коррекциях на тренде. С ними придется смириться.</li>
							<li>Если мы воспользуемся в качестве фильтра еще одной скользящей
 средней, первичный сигнал появится на пересечении двух скользящих 
средних. В итоге получим торговый метод, где первичный сигнал и фильтр 
образуют одно действие. Таких вариантов очень много. Есть и индикаторы, 
которые объединяют оба блока торгового метода. </li>
						</ul>
						<p><img src="SMA_files/9.jpg" alt=""></p>
						<ul>
							<li>В качестве фильтра можно использовать индикатор направленного
 движения ADX. Он показывает, есть на рынке тренд или нет. Когда 
индикатор растет, на рынке есть направленное движение. И неважно — в 
какую сторону. Фильтр будет звучать так: <b><em>мы открываем длинные позиции при пересечении цены и скользящей средней, если линия ADX растет.</em></b>
 Он обеспечивает достаточное запаздывание для четкого определения 
тренда. Пропускается часть тренда уменьшается величина средней 
прибыльной сделки. Но увеличивается количество прибыльных сделок.</li>
							<li>Для фильтра подойдет и сама направленность скользящей средней. В этом случае <b><em>мы
 открываем длинные позиции, если значение скользящей средней на текущем 
баре выше ее же значения на прошлом баре или двумя барами ранее.</em></b>
 На рисунке видно, как на падении при коррекции цена пересекала снизу 
вверх скользящую среднюю, и что все сделки привели бы к убыткам. 
Введенный нами фильтр аннулирует убыточные сделки, тем самым, повышая 
процент прибыльных сделок.</li>
						</ul>
						<p><img src="SMA_files/10.jpg" alt=""></p>
						<ul>
							<li>Одним из показательных торговых методов является система, 
которую применяли «Черепашки» (три дня Дончиана). Длинная позиция 
открывается, если цена поднялась выше 20 дневного максимума. Для 
удобства применения этого метода в программах технического анализа 
графиков есть индикатор «Ценовой канал», который отслеживает 
максимальное и минимальное значения цены за конкретный период и наглядно
 показывает, при пробитии какого значения нужно покупать и при каком — 
продавать. Все хорошо, но при падении на отскоках нас будет затягивать в
 убыточные позиции. Чтобы их отфильтровать, Дончиан предложил 
использовать в качестве фильтра скользящую среднею, а именно — ее 
наклон. Фильтр звучит так: <b><em>если наклон скользящей средней отрицателен, игнорируются все сигналы на покупку.</em></b></li>
							<li>Помимо образцов трендовых методик, есть контртрендовые 
индикаторы. Если рассмотреть торговый метод на основании индекса силы 
Уайлдера (RSI), то, покупая при выходе индикатора из зоны 
перепроданности и продавая при выходе индикатора из зоны 
перекупленности, мы неплохо зарабатываем, если рынок находится в 
боковике. Но как только он переходит в тренд, сигналы этого индикатора 
приводят к убыткам. Для фильтрации подобных сигналов Болинджер предложил
 использовать скользящую среднюю с отложенными от нее полосами на 
величину двух стандартных отклонений. В этом случае фильтр будет звучать
 так: <b><em>мы применяем сигналы на покупку и продажу от нашего индикатора RSI, если цена находится в границах полос Болинджера</em></b>, <b><em>и игнорируем их, если цена выходит за рамки полос Болинджера.</em></b> </li>
						</ul>
						<p>После разбора нескольких примеров становится понятно, что 
достичь паритетного соотношения между количеством прибыльных и убыточных
 сделок возможно. Запрограммировав свой торговый метод в программе 
технического анализа графиков, мы запрограммировали и первичный сигнал, и
 фильтр, и заодно протестировали свой метод на исторических графиках, 
получили соотношение прибыльных и убыточных сделок и коэффициент 
соотношения средней прибыльной сделки к средней убыточной: 50х50 1,8</p>
						<p>Добавим фильтр в код, <b>к пересечению цены и скользящей средней добавим положительный наклон этой скользящей средней как фильтр</b>:</p>
						<pre>﻿var Bar, p: integer;
PlotSeries( SMASeries( #Close, 20 ), 0, #Teal, #Thick );
for Bar := 20 to BarCount - 1 do
begin
  if LastPositionActive then
  begin
    p := LastPosition;
    if CrossUnder( Bar, #Close, SMASeries( #Close, 20 ) ) then
    begin
      SellAtMarket( Bar + 1, p, '' );
    end;
  end
  else
  begin
    if not LastPositionActive then
    begin
      if SMA( Bar, #Close, 20 ) &gt; SMA( Bar - 1, #Close, 20 ) then
      begin
        if CrossOver( Bar, #Close, SMASeries( #Close, 20 ) ) then
        begin
          BuyAtMarket( Bar + 1, '0' );
        end;
      end;
    end;
  end;
end;</pre>
						<p>На графике сразу видно как исчезло большое количество убыточных
 сделок, и мы достигли то, что задумали. Рынок падал, а потом стал расти
 и нам нужно тут просто купить. Что у нас и получилось.</p>
						<p><img src="SMA_files/11.jpg" alt=""></p>
						<p>Итак, паритет между прибыльными и убыточными сделками 
достигнут. Когда, наконец, все устраивает, обращаемся ко второму 
показателю — соотношению средней прибыльной сделки и средней убыточной. 
Что теперь не так? Скорее всего, не нравится маленькая величина этого 
показателя. Для его увеличения нужно двигаться сразу в двух направлениях
 — уменьшать величину средней убыточной сделки и увеличивать размер 
средней прибыльной.</p>
						<p><b><em>Третий блок. Первичный стоп</em></b></p>
						<p>Первичный стоп нужен, чтобы уменьшить величину убытка от 
сделки. Мы не ликвидируем такую сделку по факту, но уменьшаем негативные
 последствия. До введения «первичного стопа» сигналом на закрытие 
позиции служило зеркальное отражение нашего «первичного сигнала». 
Складывается ситуация, когда цена находится выше «первичного сигнала», 
но есть предпосылки на то, что удерживать позицию дальше не имеет 
смысла, потому что вряд ли она приведет к прибыли. Чтобы определить 
данный момент и своевременно закрыть позицию, и нужен «первичный стоп».</p>
						<p><img src="SMA_files/12.jpg" alt=""></p>
						<p>Есть правильные методы выставления «первичных стопов». Они 
основаны на понимании теории вол Эллиотта. Эксперт утверждал, что если 
идет направленное движение, все откаты цены не превосходят по величине 
волны движения. Коррекционные волны всегда меньше волн движения; при 
коррекции цена не достигает уровня начала движения. Если же она его 
коснется, на рынке нет движения или есть, но в противоположном 
направлении к вашим позициям. Поэтому если цена на откате преодолевает 
точку начала волны движения, удерживать позицию не имеет смысла. И 
наоборот: возможно, есть смысл перевернуться — закрыть предыдущую 
позицию и открыть новую в противоположном направлении.</p>
						<p><img src="SMA_files/13.jpg" alt=""></p>
						<p>Согласно этому подходу мы выставляем свой «первичный стоп» на минимуме той волны движения, в которой нас затащило в позицию.</p>
						<p>Мы добавили такой стоп себе в код:</p>
						<pre>﻿var Bar, p: integer;
PlotSeries( SMASeries( #Close, 20 ), 0, #Teal, #Thick );
PlotSeries( OffsetSeries(LowestSeries( #Low, 20 ),-1), 0, #Blue, #Thin );
for Bar := 20 to BarCount - 1 do
begin
  if LastPositionActive then
  begin
    p := LastPosition;
    if CrossUnder( Bar, #Close, SMASeries( #Close, 20 ) ) then
    begin
      SellAtMarket( Bar + 1, p, '' );
    end
    else
    if CrossUnder(Bar,#Low,OffsetSeries(LowestSeries( #Low, 20 ),-1)) then
    begin
       SellAtMarket(Bar+1, LastPosition, 'ExitLong');
    end;
  end
  else
  begin
    if not LastPositionActive then
    begin
      if SMA( Bar, #Close, 20 ) &gt; SMA( Bar - 1, #Close, 20 ) then
      begin
        if CrossOver( Bar, #Close, SMASeries( #Close, 20 ) ) then
        begin
          BuyAtMarket( Bar + 1, '0' );
        end;
      end;
    end;
  end;
end;</pre>
						<p>На графике он виден синей линией идущей от минимальных значений:</p>
						<p><img src="SMA_files/14.jpg" alt=""></p>
						<p><b><em>Четвертый блок. Текущий стоп</em></b></p>
						<p>Благодаря предыдущему блоку мы уменьшили величину средней 
убыточной сделки. Теперь пора думать, как повысить размер средней 
прибыльной сделки. На рынке часто складывается ситуация, когда цена 
находится выше и «первичного сигнала», и «первичного стопа», и при этом 
есть предпосылки для закрытия позиции. Если же цена упадет, наша 
«бумажная» прибыль растает, хотя, возьми мы ее, она увеличила бы размер 
сделки. Таким образом, в метод просится еще один блок — «текущий стоп».</p>
						<p><img src="SMA_files/15.jpg" alt=""></p>
						<p>
							Для реализации «текущего стопа» можно использовать 
разныеиндикаторы. Для начала разберем сам подход с точки зрения теории 
волн. Эллиотт утверждал, что коррекционные волны всегда короче волн 
движения, поэтому защитные остановки и стопы лучше размещать на 
минимумах волн движения. Если они срабатывают, значит, движение, тренд 
закончился, и хорошо, что мы вышли из рынка. Именно по такому принципу 
выставляется «первичный стоп» на минимуме первой волны движения. Но что 
делать дальше? Как воспользоваться волновой теорией, чтобы превратить 
«первичный стоп» в «текущий»?<br>
							Согласно закону волн, если цена преодолевает свое предыдущее 
максимальное значение, на рынке развивается тенденция. В данный момент 
он находится в волне движения, и ее минимум можно использовать для 
выставления защитной остановки. Таким образом, мы перемещаем свой 
«первичный стоп» с минимума первой волны на минимум второй волны. В 
данный момент наш стоп может еще не защищать часть нашей прибыли. То, 
что он уменьшит размер нашей убыточной сделки — это точно.
						</p>
						<p><img src="SMA_files/16.jpg" alt=""></p>
						<p>Тенденция развивается дальше, и на смену волне отката приходит 
волна движения. Движение продолжается, и цена преодолевает предыдущий 
максимум. Затем мы аккуратненько переносим свой стоп на минимум 
следующей волны. В этом случае стоп точно защищает нашу прибыль, то есть
 превращается в «текущий стоп».</p>
						<p><img src="SMA_files/17.jpg" alt=""></p>
						<p>Какой индикатор выбрать для реализации «текущего стопа» в своем
 торговом методе, — решать самому трейдеру. При этом нельзя забывать 
главный принцип: после того, как срабатывает «текущий стоп”, цена не 
всегда идет против нас. Она может развернуться и пойти в прежнем 
направлении, а мы уже ликвидировали свои позиции. Чтобы ничто не мешало 
зарабатывать на тренде, «текущий стоп» необходимо предусмотреть на 
должном расстоянии от цены; он не должен к ней «прилипать». Так у нас 
будет шанс снова войти в рынок на основании «первичного сигнала». 
Следовательно, «первичный сигнал» и «текущий стоп» следует разрабатывать
 вместе, чтобы они дополняли друг с друга.</p>
						<p>В нашем коде не пришлось ничего менять, так как условие, 
которое мы прописали при иницилизации первиченого стопа выполняют еще и 
функции скользящего стопа. На графике видно как синия линия начала 
скользить за графиком при росте цены:</p>
						<p><img src="SMA_files/18.jpg" alt=""></p>
						<p>Мы разобрали все четыре блока, из которых может состоять 
торговый метод. И наши усилии не прошли даром. Созданный нами торговый 
метод показал результаты лучше, чем если бы мы просто купили акции и их 
просто держали в своем портфеле. Зеленым цветом показан наш счет, а 
синия линия показывает результативность пассивного портфеля.</p>
						<p><img src="SMA_files/19.jpg" alt=""></p>
						<p>
							В завершение нужно сказать несколько общих слов по этому поводу. 
Сразу отмечу: для прибыльной торговли подойдет и одноблочный, и 
двухблочный и многоблочный торговый метод. Для дохода набор блоков роли 
не играет. Но разница существует. Она проявляется в соотношении средней 
годовой доходности и максимального падения капитала, встречающегося в 
истории. <br>
							Рассматривая соотношение средней годовой доходности и величины 
максимального исторического падения капитала, мы выявим некоторую 
закономерность. У одноблочных или двухблочных торговых методов заметно 
равенство этих двух показателей. Например, если у такого метода 
среднегодовая доходность лежит в районе 30%, то и падение капитала 
находится в той же области. А если доходность выше и составляет 60%, 
нужно готовиться к тому, что в один прекрасный момент капитал упадет на 
эти самые 60%. Собираясь работать с такими торговыми методами, нужно 
учитывать эту зависимость.<br>
							Если торговый метод насчитывает три блока или более, зависимость 
между средней годовой доходностью и максимальным падением капитала 
начинает смещается в сторону доходности. Например, если наш трехблочный 
метод показывает доходность в 30%, от него вполне ожидаемо падение 
капитала в районе 20%. <br>
							Еще пара советов для более удачной работы. Чтобы улучшить 
результаты трейдинга (сгладить колебания на кривой доходности счета), 
можно использовать сразу несколько торговых систем. Желательно подобрать
 такие, которые имеют небольшую корреляцию результатов. Сформируйте 
группу систем, распределяя между ними свой капитал, а результаты 
суммируйте и ведите общую статистику по счету. Суммарный итог работы 
портфеля систем всегда оказывается выше результатов отдельных систем.<br>
							Далее разделите длинные и короткие позиции по отдельным системам.
 Так, чтобы одни торговали исключительно от покупки (с длинной стороны),
 а другие, если будет нужда, — только от продажи (с короткой стороны). 
Различия в природе, механизмах роста и падения акций подразумевают 
наличие разных систем и их параметров для торговли "вверх" или "вниз ". 
Хотя существуют и универсальные системы для движения в обоих 
направлениях. Более эффективными всегда оказываются те из них, которые 
разделяют длинные и короткие позиции.
						</p>
						<p>
							<b>Как самому реализовать торговую систему и работать по ней </b><br>
							Итак, мы разобрались, как будем создавать, тестировать и 
оптимизировать свой торговый метод, и какие нюансы есть при его 
разработке. Но это все — теория. А как подступиться на практике? <br>
							С торговой идеей придется помучиться, таковых всегда много. 
Каждый раз надо будет проверять ее работоспособность, то есть 
тестировать на исторических данных. Сделать это можно тремя способами:
						</p>
						<ul>
							<li>вручную, открывая бар за баром и записывая сделки;</li>
							<li>автоматически в программе технического анализа (например, TradeMatic);</li>
							<li>автоматически, написав свою собственную программу на языке программирования (например, С# или C++).</li>
						</ul>
						<p>Поскольку ручное тестирование отнимает очень много времени и 
связано с большим количеством субъективных ошибок (например, пропуски 
сделок из-за усталости при тестировании больших объемов данных), а 
языками программирования на профессиональном уровне владеют немногие, 
тестирование системы в программе теханализа является оптимальным 
вариантом для большинства трейдеров.</p>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div id="footmenu" class="clearfix">
		<ul>
			<li><a href="http://robostroy.ru/faq/">Как создать торгового робота</a></li>
			<li><a href="http://robostroy.ru/lab/">Лаборатория</a></li>
			<li><a href="http://robostroy.ru/community/">Сообщество</a></li>
			<li><a href="http://robostroy.ru/about/">О проекте</a></li>
		</ul>
	</div>
	<div id="footer">
		<div id="quik_links" class="clearfix">
			<dl>
				<dt>Платформы</dt>
				<dd><a href="http://robostroy.ru/faq/software/tradematic.aspx">Tradematic</a></dd>
				<dd><a href="http://robostroy.ru/faq/software/quik.aspx">Quik</a></dd>
				<dd><a href="http://robostroy.ru/faq/software/wealthlab.aspx">Wealth-Lab</a></dd>
				<dd><a href="http://robostroy.ru/faq/software/omega.aspx">Omega</a></dd>
				<dd><a href="http://robostroy.ru/faq/software/metastock.aspx">Metastock</a></dd>
			</dl>
			<dl>
				<dt>Создание роботов</dt>
				<dd><a href="http://robostroy.ru/faq/webinar/">Вебинары</a></dd>
				<dd><a href="http://robostroy.ru/faq/video/quik.aspx">Видеокурсы</a></dd>
				<dd><a href="http://robostroy.ru/faq/library/">Библиотека</a></dd>
				<dd><a href="http://robostroy.ru/robots/">Биржа роботов</a></dd>
			</dl>
			<dl>
				<dt>Сообщество</dt>
				<dd><a href="http://robostroy.ru/community/default.aspx?cid=strategies">Стратегии</a></dd>
				<dd><a href="http://robostroy.ru/community/default.aspx?cid=robots">Роботы</a></dd>
				<dd><a href="http://robostroy.ru/community/default.aspx?cid=theory">Теория</a></dd>
				<dd><a href="http://robostroy.ru/community/default.aspx?cid=technologies">Технологии</a></dd>
				<dd><a href="http://robostroy.ru/community/default.aspx?cid=news">Новости</a></dd>
				<dd><a href="http://robostroy.ru/community/default.aspx?cid=analytics">Торговые рекомендации</a></dd>
			</dl>
			
			<div class="partners">
				<h3>Партнеры проекта</h3>
				<p>
					<a href="http://broker.ru/brokerage"><img src="SMA_files/fgbcs_logo.gif" alt="" width="122" height="44"></a>
				</p>
			</div>
		</div>
		<div id="copyright">
			<div class="logo">
				<a href="http://robostroy.ru/"><img src="SMA_files/robostroy_inv.png" alt="Робострой"></a>
			</div>
			<div class="robohand">
				<img src="SMA_files/robohand.png" alt="">
			</div>
			<div class="disclaimer">
				<p>2011 — 2014 © robostroy.ru</p>
				<p><a href="http://robostroy.ru/agreement/">Пользовательское соглашение</a></p>
				<br>
				
	<script id="top100Counter" src="SMA_files/top100.gif"></script>

			</div>
			<div class="support">
				<p><a href="#feedbackForm" id="feedbackFormLink">Написать администратору</a></p>
			</div>
			<div class="designer">
				<p>Дизайн сайта — <!--noindex--><a href="http://www.openproject.ru/" target="_blank" rel="nofollow"><i class="xq"></i></a><!--/noindex--></p>
			</div>
		</div>
	</div>
</div>
<div class="common-hidden">
	<form id="feedbackForm" action="/feedfack.ashx" method="post">
		<input name="ValidationToken" id="ValidationToken" value="alsertjghljfsmzgj.lhgjnlvz;jntg" type="hidden">
		<input name="mytoken" id="mytoken" value="" type="hidden">

		<div class="fancybox-title-inside-top">
			<h3>Написать администратору</h3>
		</div>
		<input name="action" value="send" type="hidden">
		<div class="content">
			<div class="label">
				<label>Имя:</label>
				<span id="feedbackFormUserNameError" class="invalid"></span>
			</div>
			<div class="username">
				<input id="feedbackFormUserName" name="username">
			</div>
			<div class="label">
				<label>E-mail:</label>
				<span id="feedbackFormUserMailError" class="invalid"></span>
			</div>
			<div class="usermail">
				<input id="feedbackFormUserMail" name="usermail">
			</div>
			<div class="label">
				<label>Сообщение:</label>
				<span id="feedbackFormMessageError" class="invalid"></span>
			</div>
			<div class="textbox">
				<textarea id="feedbackFormMessage" name="message" cols="60" rows="10"></textarea>
			</div>
			<div class="submit">
				<input value="Отправить" type="submit">
			</div>
		</div>
	</form>
</div>
<div class="seo_counters">
	
	<script>document.write("<a href='http://www.liveinternet.ru/click' target=_blank><img src='//counter.yadro.ru/hit?t14.6;r" + escape(document.referrer) + ((typeof (screen) == "undefined") ? "" : ";s" + screen.width + "*" + screen.height + "*" + (screen.colorDepth ? screen.colorDepth : screen.pixelDepth)) + ";u" + escape(document.URL) + ";h" + escape(document.title.substring(0, 80)) + ";" + Math.random() + "' border=0 width=1 height=1 alt='' title=''><\/a>")</script><a href="http://www.liveinternet.ru/click" target="_blank"><img src="SMA_files/hit_002.gif" alt="" title="" border="0" width="1" height="1"></a>
	<script>document.write("<a href='http://www.liveinternet.ru/click;BrokerCreditService' target=_blank><img src='//counter.yadro.ru/hit;BrokerCreditService?t14.6;r" + escape(document.referrer) + ((typeof (screen) == "undefined") ? "" : ";s" + screen.width + "*" + screen.height + "*" + (screen.colorDepth ? screen.colorDepth : screen.pixelDepth)) + ";u" + escape(document.URL) + ";h" + escape(document.title.substring(0, 80)) + ";" + Math.random() + "' border=0 width=1 height=1 alt='' title=''><\/a>")</script><a href="http://www.liveinternet.ru/click;BrokerCreditService" target="_blank"><img src="SMA_files/hit.gif" alt="" title="" border="0" width="1" height="1"></a>
	<script>
		(function () {
			var g = document.createElement('script'),
				s = document.getElementsByTagName('script')[0];
			g.type = 'text/javascript';
			g.async = true;
			g.src = 'http' + ('https:' == document.location.protocol ? 's://' : '://') + 'stats.g.doubleclick.net/dc.js';
			s.parentNode.insertBefore(g, s);
		})();
	</script>

	<!-- Piwik -->
	<script>
		var _paq = _paq || [];
		_paq.push(['trackPageView']);
		_paq.push(['enableLinkTracking']);
		(function () {
			var u = '//stat.bcs.ru/p/';
			_paq.push(['setTrackerUrl', u + 'piwik.php']);
			_paq.push(['setSiteId', 4]);
			var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
			g.type = 'text/javascript'; g.async = true; g.defer = true; g.src = u + 'piwik.js'; s.parentNode.insertBefore(g, s);
		})();
	</script>
	<noscript><p><img src='//stat.bcs.ru/p/piwik.php?idsite=4' style='border: 0;' alt='' /></p></noscript>
<!-- End Piwik Code -->


</div>

<div id="fancybox-tmp"></div><div id="fancybox-loading"><div></div></div><div id="fancybox-overlay"></div><div id="fancybox-wrap"><div id="fancybox-outer"><div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div><div id="fancybox-content"></div><a id="fancybox-close"></a><div id="fancybox-title"></div><a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a><a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a></div></div></body></html>